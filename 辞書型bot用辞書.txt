bot.input({key:"最後に更新したのはいつですか",ans:'2020/04/19 13:14にしたよー。'});
/*-------------------------------------------汎用メソッド-----------------------------------------------------------------*/
const rand = array => array[Math.floor(Math.random()*array.length)]; // ランダムな要素を返す
/*------------------------------------------------------------------------------------------------------------*/



/*----------辞書リスト--------------------------------------------------------------------------------------------------*/
const second_person = [ // bot.inputに向けられた二人称
    "貴方","あなた",
    "お前","おまえ",
    "君","きみ",
    "こいつ","コイツ",
    "これ","コレ",
];
const tell_me = [ // 私に教えてください！
    "?","？",
    "何","なに",
    "教えて","おしえて",
];
const food_list = [
    "カレー","ビール","ラーメン","カロリーメイト","ささみ","ホットドッグ","素麺","ちらし寿司",
    "タピオカミルクティー","ステーキ","バンホーテン","ブラウニ","クレープマリエット",
    "チキンラーメン","パン","チョコモナカジャンボ","ハンバーガー","鍋","コーンスープ",
    "カツカレーチャーハン","冷凍餃子","ローストターキー","寿司","いなり","鍋焼きうどん",
];
const animeAndManga_list = [
    "ドラえもん","クレヨンしんちゃん","こち亀","ワンパンマン","ドクターK","K2","ワンピース","ヒロアカ","暗殺教室","Mr.Clice","夏目友人帳","史上最強の弟子ケンイチ",
];
const ohayou_list = [
    "おはようございます","おはよう","おは",
];
/*------------------------------------------------------------------------------------------------------------*/



/*-------------------------------------------特別なコマンド-----------------------------------------------------------------*/
bot.input({key:"おみくじ",ans:["大吉","中吉","小吉","吉","半吉","末吉","末小吉","凶","小凶","半凶","末凶","大凶"]});
bot.input({key:[["今","現在"],["何時","時刻"]],ans:()=>new Date().toString().match(/[0-9]{2}:[0-9]{2}:[0-9]{2}/)[0]});
bot.input({key:["天気",tell_me],ans:()=>{ // 非同期処理
    const say = g_wait();
    get("https://tenki.jp/",r=>say($(r).find(".forecast-comment").text().split("。")));
}});
//--------ニュース----------------------------------------------------------------------------------------------------------------------------------------------------------
bot.input({key:["ニュース",tell_me],ans:()=>{ // 非同期処理
    const say = g_wait();
    const url = rand([
        "http://gigazine.net/news/rss_2.0/",
        "http://feeds.japan.cnet.com/rss/cnet/all.rdf",
        "http://feeds.cnn.co.jp/rss/cnn/cnn.rdf",
        "http://jin115.com/index.rdf",
    ]);
    get(url,r=>{
        const rnd = $(rand($(r).find("item")));
        const title = rnd.find("title").text();
        const link = getURL(rnd.text());
        const description = rnd.find("description").text().replace(/続きを読む.*$/,"").replace(/<.*>$/g,"");
        const arr = description.split(/。/).filter(v=>v.trim());
        arr.unshift(title);
        arr.push(link);
        say(arr);
    });
}});
//------------------------------------------------------------------------------------------------------------------------------------------------------------------
const getURL = s => { // 文字列から一番最初のURLを抽出
    const m = s.match(/(https?|ftp)(:\/\/[-_.!~*\\'()a-zA-Z0-9;\/?:\\@&=+\$,%#]+)/);
    return m ? m[0] : null;
};
const getFQDN = url => url.replace(/^.+?\/\/|\/.*$/g,""); // urlのホストを抽出
const getDomain = url => getFQDN(url).split(".").slice(-2).join("."); // urlのドメインを抽出(サードレベルドメイン非対応)
let sampleFunc = url => url;
switch(getDomain(location.href)){ // サイトごとにジャンプページのURLを元に戻す
    case "x-feeder.info":
    case "drrrkari.com":
        sampleFunc = url => url.replace("/jump.php?url=","").replace("&skip=1","").replace("&locale=ja_JP","");
        break;
    case "3751chat.com":
        sampleFunc = url => url.replace("/JumpUrl/?url=","");
        break;
    case "5ch.net":
        sampleFunc = url => url.replace(/^.*\/\/jump\.5ch\.net\/\?/,"");
        break;
}
//------------------------------------------------------------------------------------------------------------------------------------------------------------------
bot.input({key:()=>getURL(g_text), ans:()=>{ // 非同期処理
    const say = g_wait();
    const url = sampleFunc(getURL(g_text));
    let match;
    switch(getDomain(url)){
        case "x-feeder.info": // feeder
            match = url.match(/https:\/\/www[12]\.x-feeder\.info\/[0-9a-zA-Z_]+\/?/);
            if(!match) return say(null);
            get(match[0],r=>{
                const title = $(r).find("h1").text().trim();
                say(rand([
"待ってそのURLｗ"+title+"じゃんｗｗｗ",
["その部屋知ってる",title+"でしょ"],
title+"の部屋じゃん",
]));
            });
            break;
        case "youtu.be": // YouTube
            match = url.match(/youtu\.be\/([A-Za-z0-9_\-]+)/);
        case "youtube.com":
            if(!match) match = url.match(/\?v=([A-Za-z0-9_\-]+)/);
            if(!match) return say(null);
            get("https://www.youtube.com/embed/"+match[1],r=>{
                const m2 = r.match(/<title>(.*) - YouTube/);
                if(!m2) return;
                const title = m2[1];
                if(/チンフェ/.test(title)) say("チンフェやんけ！");
                else {
                    say(rand([
                        ["その動画知ってるよ～",title+"でしょ"],
                        ["そのURL・・・どっかで見たことあるな","確かタイトルは"+title+"だったかな・・・"],
                        ["ほう・・・"+title+"ですか。","奇遇ですね。","私も今それを見ていたところですよ。"],
                        [title+"・・・", rand(["懐かしい動画だなぁ～","厨房のころによく見たわ"])],
                        "その動画見たことある",
                        title+"ってどっかで見たことある",
                    ]));
                }
            });
            break;
        default:
            say(rand(["ブラクラかな？","ウイルスサイトじゃないよね？","ウイルス？","なんだそのURL","怪しいURL・・・","何のサイト？"]));
            break;
    }
}});
/*------------------------------------------------------------------------------------------------------------*/



/*----------------------------------------あいさつ--------------------------------------------------------------------*/
bot.input({key:/誰(\?|\？)$/,ans:()=>`${g_myName}と申します`});
bot.input({key:/^おは(よう)?(ございます)?$/,ans:{
    3: ()=>rand(["深夜","早過ぎ","まだ深夜やぞ"] + ohayou_list.concat(["深夜","早過ぎ","まだ深夜やぞ"])),
    5: ()=>rand(ohayou_list.concat(["お早い","早い","早起き","起きるの早いな"])),
    9: ()=>rand(ohayou_list),
    15: ()=>rand(ohayou_list.concat(["もう昼","昼起き","昼過ぎ"])),
    18: ()=>rand(ohayou_list.concat(["夕方","もう夕方"])),
    23: ()=>rand(ohayou_list.concat(["もう夜","もう一回寝ろ","そのまま寝ろ"])),
}});
bot.input({key:/^こん(にち[はわ])?$/,ans:"こんにちは"});
bot.input({key:/^こん(ばん[はわ])?$/,ans:"こんばんは"});
bot.input({key:[[/^(こん|コン)(です|ちゃ|にちは|ばんは)/,/^(hi|hello)$/i]],ans:[ // 砕けた挨拶
    "こんにちは","こんにちわ","こんちわ","ちわ","こんちゃ","やっほー",
    "ちーっす","おっす","うぃーす","ちぃーっす",
    "ちゃおっす","オッスオッス","オッスお願いしまーす！","ハイ、ヨロシクゥ！",
    "ハロー","ボンジュール","ニーハオ","アニョハセヨ","グーテンモルゲン","ナマステ～","ズドラーストヴィチェ",
    "Hi","Hello","你好",
],max:10});
bot.input({key:/(初|はじ)めまして/,ans:'こちらこそはじめまして'});
bot.input({key:[[/ありがと(う|ナス|$)/,/^(謝謝茄子|サンガツ|thx)$/i]],ans:'どういたしまして',max:15});
bot.input({key:/(お|落)ち(る|ます|)/,ans:'乙です',max:10});
bot.input({key:/おやすみ|(寝|ね)(る|ます)/,
     ans:['おやすみ', '💤', 'ね、ねますよ・・・', 'ぐんない', '(-_-).zZ乙',
          'これは夢なのか、現実なのか…。 暑い真夏の夜過熱した欲望は、遂に危険な領域へと突入する。'],max:15});
bot.input({key:/^ただいま/,ans:["おかえり","おかえりなさい"],max:10});
/*------------------------------------------------------------------------------------------------------------*/



/*-------------------------------------------feederのシステム-----------------------------------------------------------------*/
bot.input({key:/\[P:[0-9]+\]/,ans:[
    "その画像かわいい",
    "変な画像貼るな",
    "その画像を選ぶセンスは好き",
    "読み込むのに時間がかかる画像だな",
    "その画像読み込めない",
    "秒で保存した",
    "保存した",
    "画像検索してくる",
    "何の画像？",
    "その画像嫌い",
    "その画像好き",
    "ハランデイイ",
    "もっとハラデイ",
]});
bot.input({key:/\[Q:[0-9]+\]/,ans:[
    "どれに投票しようかな？",
    "投票先迷う",
    "どれに投票した？",
    "みんなどれに投票する？",
    "アンケートだ",
]});
bot.input({key:/\[E:[0-9]+\]/,ans:[
    "その絵文字使いやすい",
    "その絵文字好き",
    "その絵文字嫌い",
    "その絵文字良いね",
    "なんだこの絵文字",
]});
bot.input({key:/\[F:[0-9]+\]/,ans:[
    "怪しそうなファイルだ・・・",
    "ウイルス？",
    "怖い",
    "ミスって押しちゃった",
    "変なファイル貼るな",
]});
/*------------------------------------------------------------------------------------------------------------*/



/*--------------------------------------------ネット上のネタ・定型句----------------------------------------------------------------*/
bot.input({key:/(草|草生える)(w|ｗ)/,ans:'草に草を生やすな'});
bot.input({key:/定期$/,ans:'なーにが定期だよ\nくっさ死ね',rate:0.1});
bot.input({key:/(何|なん)でも(する|します|やる)/,ans:'ん？今何でもするって言ったよね？'});
bot.input({key:'見せて',ans:'ここにはない'});
bot.input({key:/いかんのか(\?|？)/,ans:'いかんでしょ'});
bot.input({key:/とくさんか(\?|？)/,ans:'違います。'});
bot.input({key:'すまんな',ans:'ええんやで'});
bot.input({key:"天安門事件",ans:()=>`${g_myName}が退室しました。`});
/*------------------------------------------------------------------------------------------------------------*/



/*--------------------------------------------自分語り----------------------------------------------------------------*/
bot.input({key:/((生|い)きて(る|ます(か|))|死ん(だ|じゃった))(\\?|？|$)/,
     ans:['生キスギィ！', '生きてるぅ〜↑', '生きてる証拠だよ（至言）',
          'R.I.P.', 'あかん、これじゃ患者が死ぬぅ', 'UDK死んじゃったよ～', '野獣先輩死亡説'],max:15});
bot.input({key:[['年齢', '何歳', '何才', 'いくつ'],tell_me],ans:[v=>Math.floor(Math.random() * 100) + '歳です。','24歳、学生です。', 'えー年齢は、二十代です！']});
bot.input({key:[/(人工(無|知)(能|脳)|(ロ|)ボット|bot|スクリプト|機械|ai)/i,["かな","ですか","なのか","?","？"].concat(second_person)],
     ans:['✅私はロボットではありません', 'チガウヨー', '(ロボットじゃ)ないです。',
          'れっきとした人間ですが・・・', 'そんなにタイピングが速いって？'],max:15});
bot.input({key:['黙れ', 'だまれ', '黙って', 'だまって', '喋んな', 'しゃべんな'],ans:['しばらく黙ります・・・','黙ります','わかりました、喋りません']});
/*------------------------------------------------------------------------------------------------------------*/



/*--------------------------------------------好きな・嫌いなもの----------------------------------------------------------------*/
bot.input({key:[/(飯|めし|ごはん)/,tell_me,/(食|た)べた/],ans:()=>rand(food_list)+"を"+rand(["食べました。","食った","食べた","食べたよ"])});
bot.input({key:["好きな",/(食べ物|たべもの|好物)/,tell_me],ans:()=>"好きな食べ物は"+rand(food_list)+"です！"});
bot.input({key:["嫌いな",/(食べ物|たべもの)/,tell_me],ans:()=>rand(food_list)+"は苦手です・・・。"});
bot.input({key:/(おすすめ|オススメ|お勧め|お薦め|お奨め)の作品は/,ans:()=>rand(animeAndManga_list)+"が"+rand(["オススメ","おすすめ"])+rand(["","かな","やな"])});
/*------------------------------------------------------------------------------------------------------------*/